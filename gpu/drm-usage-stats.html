<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>DRM client usage stats &mdash; The Linux Kernel  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
      <link rel="stylesheet" href="../_static/theme_rtd_colors.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="DRM Driver uAPI" href="driver-uapi.html" />
    <link rel="prev" title="Userland interfaces" href="drm-uapi.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          </a>
              <div class="version">
                6.1.0-rc6
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../process/development-process.html">A guide to the Kernel Development Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/submitting-patches.html">Submitting patches: the essential guide to getting your code into the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/code-of-conduct.html">Code of conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">All development-process docs</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../subsystem-apis.html">Kernel subsystem documentation</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../locking/index.html">locking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../accounting/index.html">Accounting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../block/index.html">Block</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cdrom/index.html">cdrom</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cpu-freq/index.html">Linux CPUFreq - CPU frequency and voltage scaling code in the Linux(TM) kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fb/index.html">Frame Buffer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fpga/index.html">fpga</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hid/index.html">Human Interface Devices (HID)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../i2c/index.html">I2C/SMBus Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../iio/index.html">Industrial I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="../isdn/index.html">ISDN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../infiniband/index.html">InfiniBand</a></li>
<li class="toctree-l2"><a class="reference internal" href="../leds/index.html">LEDs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../netlabel/index.html">NetLabel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../networking/index.html">Networking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pcmcia/index.html">pcmcia</a></li>
<li class="toctree-l2"><a class="reference internal" href="../power/index.html">Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../target/index.html">TCM Virtual Device</a></li>
<li class="toctree-l2"><a class="reference internal" href="../timers/index.html">timers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../spi/index.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../w1/index.html">1-Wire Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../watchdog/index.html">Linux Watchdog Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../virt/index.html">Linux Virtualization Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../hwmon/index.html">Linux Hardware Monitoring</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Linux GPU Driver Developer’s Guide</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="drm-internals.html">DRM Internals</a></li>
<li class="toctree-l3"><a class="reference internal" href="drm-mm.html">DRM Memory Management</a></li>
<li class="toctree-l3"><a class="reference internal" href="drm-kms.html">Kernel Mode Setting (KMS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="drm-kms-helpers.html">Mode Setting Helper Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="drm-uapi.html">Userland interfaces</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">DRM client usage stats</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#file-format-specification">File format specification</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#driver-specific-implementations">Driver specific implementations</a></li>
<li class="toctree-l3"><a class="reference internal" href="driver-uapi.html">DRM Driver uAPI</a></li>
<li class="toctree-l3"><a class="reference internal" href="drm-client.html">Kernel clients</a></li>
<li class="toctree-l3"><a class="reference internal" href="drivers.html">GPU Driver Documentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="backlight.html">Backlight support</a></li>
<li class="toctree-l3"><a class="reference internal" href="vga-switcheroo.html">VGA Switcheroo</a></li>
<li class="toctree-l3"><a class="reference internal" href="vgaarbiter.html">VGA Arbiter</a></li>
<li class="toctree-l3"><a class="reference internal" href="todo.html">TODO list</a></li>
<li class="toctree-l3"><a class="reference internal" href="rfc/index.html">GPU RFC Section</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../filesystems/index.html">Filesystems in the Linux kernel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../usb/index.html">USB support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../PCI/index.html">Linux PCI Bus Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scsi/index.html">Linux SCSI Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../scheduler/index.html">Linux Scheduler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../mhi/index.html">MHI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../peci/index.html">Linux PECI Subsystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../locking/index.html">Locking in the kernel</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/license-rules.html">Linux kernel licensing rules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/testing-overview.html">Kernel Testing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fault-injection/index.html">fault-injection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../livepatch/index.html">Kernel Livepatching</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rust/index.html">Rust</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kbuild/index.html">The kernel build system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/reporting-issues.html">Reporting issues</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">User-space tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../firmware-guide/index.html">The Linux kernel firmware guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../devicetree/index.html">Open Firmware and Devicetree</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../arch.html">CPU Architectures</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../staging/index.html">Unsorted Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../subsystem-apis.html">Kernel subsystem documentation</a> &raquo;</li>
          <li><a href="index.html">Linux GPU Driver Developer’s Guide</a> &raquo;</li>
      <li>DRM client usage stats</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/gpu/drm-usage-stats.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="drm-client-usage-stats">
<span id="id1"></span><h1>DRM client usage stats<a class="headerlink" href="#drm-client-usage-stats" title="Permalink to this heading">¶</a></h1>
<p>DRM drivers can choose to export partly standardised text output via the
<cite>fops-&gt;show_fdinfo()</cite> as part of the driver specific file operations registered
in the <cite><a class="reference internal" href="drm-internals.html#c.drm_driver" title="drm_driver"><code class="xref c c-struct docutils literal notranslate"><span class="pre">struct</span> <span class="pre">drm_driver</span></code></a></cite> object registered with the DRM core.</p>
<p>One purpose of this output is to enable writing as generic as practicaly
feasible <cite>top(1)</cite> like userspace monitoring tools.</p>
<p>Given the differences between various DRM drivers the specification of the
output is split between common and driver specific parts. Having said that,
wherever possible effort should still be made to standardise as much as
possible.</p>
<section id="file-format-specification">
<h2>File format specification<a class="headerlink" href="#file-format-specification" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>File shall contain one key value pair per one line of text.</p></li>
<li><p>Colon character (<cite>:</cite>) must be used to delimit keys and values.</p></li>
<li><p>All keys shall be prefixed with <cite>drm-</cite>.</p></li>
<li><p>Whitespace between the delimiter and first non-whitespace character shall be
ignored when parsing.</p></li>
<li><p>Neither keys or values are allowed to contain whitespace characters.</p></li>
<li><p>Numerical key value pairs can end with optional unit string.</p></li>
<li><p>Data type of the value is fixed as defined in the specification.</p></li>
</ul>
<section id="key-types">
<h3>Key types<a class="headerlink" href="#key-types" title="Permalink to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Mandatory, fully standardised.</p></li>
<li><p>Optional, fully standardised.</p></li>
<li><p>Driver specific.</p></li>
</ol>
</section>
<section id="data-types">
<h3>Data types<a class="headerlink" href="#data-types" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>&lt;uint&gt; - Unsigned integer without defining the maximum value.</p></li>
<li><p>&lt;str&gt; - String excluding any above defined reserved characters or whitespace.</p></li>
</ul>
</section>
<section id="mandatory-fully-standardised-keys">
<h3>Mandatory fully standardised keys<a class="headerlink" href="#mandatory-fully-standardised-keys" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>drm-driver: &lt;str&gt;</p></li>
</ul>
<p>String shall contain the name this driver registered as via the respective
<cite><a class="reference internal" href="drm-internals.html#c.drm_driver" title="drm_driver"><code class="xref c c-struct docutils literal notranslate"><span class="pre">struct</span> <span class="pre">drm_driver</span></code></a></cite> data structure.</p>
</section>
<section id="optional-fully-standardised-keys">
<h3>Optional fully standardised keys<a class="headerlink" href="#optional-fully-standardised-keys" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>drm-pdev: &lt;aaaa:bb.cc.d&gt;</p></li>
</ul>
<p>For PCI devices this should contain the PCI slot address of the device in
question.</p>
<ul class="simple">
<li><p>drm-client-id: &lt;uint&gt;</p></li>
</ul>
<p>Unique value relating to the open DRM file descriptor used to distinguish
duplicated and shared file descriptors. Conceptually the value should map 1:1
to the in kernel representation of <cite><a class="reference internal" href="drm-internals.html#c.drm_file" title="drm_file"><code class="xref c c-struct docutils literal notranslate"><span class="pre">struct</span> <span class="pre">drm_file</span></code></a></cite> instances.</p>
<p>Uniqueness of the value shall be either globally unique, or unique within the
scope of each device, in which case <cite>drm-pdev</cite> shall be present as well.</p>
<p>Userspace should make sure to not double account any usage statistics by using
the above described criteria in order to associate data to individual clients.</p>
<ul class="simple">
<li><p>drm-engine-&lt;str&gt;: &lt;uint&gt; ns</p></li>
</ul>
<p>GPUs usually contain multiple execution engines. Each shall be given a stable
and unique name (str), with possible values documented in the driver specific
documentation.</p>
<p>Value shall be in specified time units which the respective GPU engine spent
busy executing workloads belonging to this client.</p>
<p>Values are not required to be constantly monotonic if it makes the driver
implementation easier, but are required to catch up with the previously reported
larger value within a reasonable period. Upon observing a value lower than what
was previously read, userspace is expected to stay with that larger previous
value until a monotonic update is seen.</p>
<ul class="simple">
<li><p>drm-engine-capacity-&lt;str&gt;: &lt;uint&gt;</p></li>
</ul>
<p>Engine identifier string must be the same as the one specified in the
drm-engine-&lt;str&gt; tag and shall contain a greater than zero number in case the
exported engine corresponds to a group of identical hardware engines.</p>
<p>In the absence of this tag parser shall assume capacity of one. Zero capacity
is not allowed.</p>
<ul class="simple">
<li><p>drm-memory-&lt;str&gt;: &lt;uint&gt; [KiB|MiB]</p></li>
</ul>
<p>Each possible memory type which can be used to store buffer objects by the
GPU in question shall be given a stable and unique name to be returned as the
string here.</p>
<p>Value shall reflect the amount of storage currently consumed by the buffer
object belong to this client, in the respective memory region.</p>
<p>Default unit shall be bytes with optional unit specifiers of ‘KiB’ or ‘MiB’
indicating kibi- or mebi-bytes.</p>
<ul class="simple">
<li><p>drm-cycles-&lt;str&gt; &lt;uint&gt;</p></li>
</ul>
<p>Engine identifier string must be the same as the one specified in the
drm-engine-&lt;str&gt; tag and shall contain the number of busy cycles for the given
engine.</p>
<p>Values are not required to be constantly monotonic if it makes the driver
implementation easier, but are required to catch up with the previously reported
larger value within a reasonable period. Upon observing a value lower than what
was previously read, userspace is expected to stay with that larger previous
value until a monotonic update is seen.</p>
<ul class="simple">
<li><p>drm-maxfreq-&lt;str&gt; &lt;uint&gt; [Hz|MHz|KHz]</p></li>
</ul>
<p>Engine identifier string must be the same as the one specified in the
drm-engine-&lt;str&gt; tag and shall contain the maximum frequency for the given
engine.  Taken together with drm-cycles-&lt;str&gt;, this can be used to calculate
percentage utilization of the engine, whereas drm-engine-&lt;str&gt; only reflects
time active without considering what frequency the engine is operating as a
percentage of it’s maximum frequency.</p>
</section>
</section>
</section>
<section id="driver-specific-implementations">
<h1>Driver specific implementations<a class="headerlink" href="#driver-specific-implementations" title="Permalink to this heading">¶</a></h1>
<p><a class="reference internal" href="i915.html#i915-usage-stats"><span class="std std-ref">i915 DRM client usage stats implementation</span></a></p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="drm-uapi.html" class="btn btn-neutral float-left" title="Userland interfaces" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="driver-uapi.html" class="btn btn-neutral float-right" title="DRM Driver uAPI" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright The kernel development community.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>